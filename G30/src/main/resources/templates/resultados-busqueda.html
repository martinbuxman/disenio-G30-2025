<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="${titulo}">Hotel Premier</title> 
    <link 
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" 
        rel="stylesheet" 
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" 
        crossorigin="anonymous">
    <link rel="stylesheet" th:href="@{/style.css}">
        <style>
        .grid-container {
        margin-top: 30px;
        padding-top: 20px;
        border-top: 2px solid #ccc; 
        }
        .centered-buttons {
        display: flex;
        justify-content: center;
        gap: 15px;
        }</style>

</head>
<body>

<div class="container mt-5">
    <h2 
        id="titulo-hotel" 
        class="
            bg-white 
            text-dark 
            p-3 
            rounded-0    
            d-inline-block
            shadow-lg" 
        style="border: 5px solid #000000;" >
        HOTEL PREMIER
    </h2>
    
    <div class="card p-4 shadow-sm">
        <h2 class="card-title text-primary">Buscar Huésped</h2>
        
        <form th:action="@{/huespedes/resultados}" th:method="GET" id="formBusquedaHuesped">
            
            <div class="row mb-3">
                <div class="col-md-6">
                    <label for="apellido" class="form-label">Apellido</label>
                    <input type="text" id="apellido" name="apellido" class="form-control" th:value="${apellido}">
                    <span id="error-apellido" class="text-danger error-message"></span>
                </div>
                <div class="col-md-6">
                    <label for="nombre" class="form-label">Nombre</label>
                    <input type="text" id="nombre" name="nombre" class="form-control" th:value="${nombre}">
                    <span id="error-nombre" class="text-danger error-message"></span>
                </div>
            </div>

            <div class="row mb-4">
                <div class="col-md-6">
                    <label for="tipo_documento" class="form-label">Tipo Documento</label>
                    <select id="tipo_documento" name="tipo_documento" class="form-select">
                        <option value="">-- Seleccionar Tipo --</option>
                        <option value="DNI" th:selected="${tipo_documento == 'DNI'}">DNI</option>
                        <option value="PASAPORTE" th:selected="${tipo_documento == 'PASAPORTE'}">Pasaporte</option>
                        <option value="LE" th:selected="${tipo_documento == 'LE'}">LE</option>
                        <option value="LC" th:selected="${tipo_documento == 'LC'}">LC</option>
                        <option value="OTRO" th:selected="${tipo_documento == 'OTRO'}">OTRO</option>
                    </select>
                    <span id="error-tipo_documento" class="text-danger error-message"></span>
                </div>
                <div class="col-md-6">
                    <label for="num_documento" class="form-label">Número Documento</label>
                    <input type="number" id="num_documento" name="num_documento" class="form-control" th:value="${num_documento}">
                    <span id="error-num_documento" class="text-danger error-message"></span>
                </div>
            </div>
            
            <div class="mt-4 modal-footer justify-content-center">
                <button type="submit" class="btn btn-primary">
                    Buscar
                </button>
            </div>
        </form>
    </div>

    
    <form th:action="@{#}" th:method="GET" id="formSeleccion">
        
        <div class="grid-container">
            <h4 class="mb-3 text-secondary">Resultados Encontrados: <span th:text="${huespedes.size()}">0</span></h4>

            <div th:if="${huespedes.isEmpty() and !mostrarModalAlta}" class="alert alert-info" role="alert">
                Utilice los campos de arriba para buscar huéspedes. Si deja los campos vacíos y presiona "Buscar", se listarán todos los huéspedes.
            </div>
            
            <div th:if="${!huespedes.isEmpty()}" class="table-responsive shadow-sm">
                <table class="table table-striped table-hover align-middle">
                    <thead class="bg-dark text-white">
                        <tr>
                            <th>Sel.</th> <th>ID</th>
                            <th>Apellido</th>
                            <th>Nombre</th>
                            <th>Tipo Doc.</th>
                            <th>Número Doc.</th>
                            <th>Nacionalidad</th>
                            <th>Teléfono</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr th:each="huesped : ${huespedes}">
                            <td>
                                <input 
                                    type="radio" 
                                    name="huespedIdSeleccionado" 
                                    th:value="${huesped.id}" 
                                    class="form-check-input"
                                    aria-label="Seleccionar Huésped">
                            </td>
                            <td th:text="${huesped.id}"></td>
                            <td th:text="${huesped.apellido}"></td>
                            <td th:text="${huesped.nombre}"></td>
                            <td th:text="${huesped.tipoDocumento}"></td>
                            <td th:text="${huesped.numDocumento}"></td>
                            <td th:text="${huesped.nacionalidad}"></td>
                            <td th:text="${huesped.telefono}"></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="mt-4 centered-buttons">
                <a th:href="@{/}" class="btn btn-secondary">
                    Cancelar
                </a>

                <button type="submit" class="btn btn-primary">
                    Siguiente
                </button>
            </div>
        </div>

    </form>

</div>

<div th:if="${mostrarModalAlta}" class="modal fade" id="modalAltaHuesped" tabindex="-1" aria-labelledby="modalAltaHuespedLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header bg-warning text-dark">
                <h5 class="modal-title" id="modalAltaHuespedLabel">Información de Búsqueda</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p class="lead">
                    ⚠️ No se han encontrado huéspedes que coincidan con los datos de búsqueda ingresados.
                </p>

            </div>
            <div class="modal-footer justify-content-center">
                <a th:href="@{/huespedes/alta}" class="btn btn-primary">
                    Aceptar
                </a>
            </div>
        </div>
    </div>
</div>
<script
src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
crossorigin="anonymous">
</script>

<script th:inline="javascript">
    /*<![CDATA[*/
    const mostrarModal = /*[[${mostrarModalAlta}]]*/ false; // Valor del modelo de Spring
    
    if (mostrarModal) {
        document.addEventListener('DOMContentLoaded', function() {
            // Inicializar y mostrar el modal de Bootstrap
            const myModal = new bootstrap.Modal(document.getElementById('modalAltaHuesped'));
            myModal.show();
        });
    }
    /*]]>*/
</script>

<script th:src="@{/script.js}"></script>

    </body>
</html>